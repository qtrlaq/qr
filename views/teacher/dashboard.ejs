<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Панель преподавателя</title>
    <link rel="stylesheet" href="/assets/styles.css" />
</head>
<body>
    <div class="container">
        <header class="header">
            <h1>Панель преподавателя</h1>
            <div>
                <span><%= currentUser.email %></span>
                <a class="btn" href="/logout">Выйти</a>
            </div>
        </header>

        <% if (!active) { %>
            <form method="post" action="/teacher/start">
                <button class="btn primary" type="submit">Начать новую сессию</button>
            </form>
        <% } else { %>
            <div class="card">
                <h2>Активная сессия</h2>
                <p>Код: <code><%= active.code %></code></p>
                <div style="margin:12px 0;">
                    <a class="btn" href="/teacher/qrcode" target="_blank">Показать QR</a>
                </div>
                <form method="post" action="/teacher/stop">
                    <button class="btn danger" type="submit">Остановить</button>
                </form>
            </div>

            <div class="card">
                <h3>Отметившиеся (последние)</h3>
                <ul>
                    <% recentAttendance.forEach(r => { %>
                        <li><%= r.email %> — <%= r.marked_at %></li>
                    <% }) %>
                </ul>
            </div>
        <% } %>

        <div class="card">
            <h3 style="margin-top:0;">Последние сессии</h3>
            <table>
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Начало</th>
                        <th>Статус</th>
                        <th></th>
                    </tr>
                </thead>
                <tbody>
                <% sessions.forEach(s => { %>
                    <tr>
                        <td>#<%= s.id %></td>
                        <td><%= s.started_at %></td>
                        <td><%= s.active ? 'Активна' : 'Завершена' %></td>
                        <td><a class="btn" href="/teacher/attendance/<%= s.id %>">Список</a></td>
                    </tr>
                <% }) %>
                </tbody>
            </table>
        </div>
    </div>
</body>
</html>


